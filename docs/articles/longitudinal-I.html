<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STAP in a Longitudinal Data Setting • rstap</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="STAP in a Longitudinal Data Setting">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstap</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">STAP Introduction</a>
    </li>
    <li>
      <a href="../articles/Spatial_Correlation_I.html">STAP-Spatial_Correlation</a>
    </li>
    <li>
      <a href="../articles/clustered_poisson.html">Spatial Correlation II</a>
    </li>
    <li>
      <a href="../articles/longitudinal-I.html">STAP in a Longitudinal Data Setting</a>
    </li>
    <li>
      <a href="../articles/misspecified-weightfunction.html">Mis-Specified Weight Function</a>
    </li>
    <li>
      <a href="../articles/scale-priors.html">Scale Priors</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>STAP in a Longitudinal Data Setting</h1>
                        <h4 class="author">Vignette Author</h4>
            
            <h4 class="date">2018-09-19</h4>
      
      
      <div class="hidden name"><code>longitudinal-I.Rmd</code></div>

    </div>

    
    
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="co">#&gt; Warning: package 'dplyr' was built under R version 3.5.1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw">library</span>(tidyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(rstap)
<span class="co">#&gt; Loading required package: Rcpp</span></code></pre></div>
<div id="data-structure-complexities" class="section level1">
<h1 class="hasAnchor">
<a href="#data-structure-complexities" class="anchor"></a>Data Structure Complexities</h1>
<p>Spatial-temporal aggregated predictor (STAP) models extension in the longitudinal setting incorporates heirarchical variance components to account for within subject or group-level correlation.</p>
<p>This setting also involves a different data structure, since exposure to built environment features now occurs across time, and subjects can move across time or space. dropping out of studies and built-environment features - stores - may close or open, the map and covariate space is dynamic. This requires a secondary id to join on in addition to the typical ‘id_key’. We’ll demonstrate this and the stap model using the simple case of homogenously distributed built environment features, with subjects measured across two time points.</p>
<p>Below we can see what the data for this kind of model might look like.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list</span>(<span class="st">'Subject Spatial-Temporal Data'</span> =<span class="st"> </span>subj_data,
     <span class="st">"BEF Spatial-Temporal Data"</span> =<span class="st"> </span>bef_data)
<span class="co">#&gt; $`Subject Spatial-Temporal Data`</span>
<span class="co">#&gt; # A tibble: 167 x 5</span>
<span class="co">#&gt;           x      y date          ID class  </span>
<span class="co">#&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;date&gt;     &lt;int&gt; &lt;chr&gt;  </span>
<span class="co">#&gt;  1 -0.701   -0.412 1974-05-11     1 Subject</span>
<span class="co">#&gt;  2 -0.415    0.622 1976-03-04     2 Subject</span>
<span class="co">#&gt;  3 -0.924   -0.314 1976-04-15     3 Subject</span>
<span class="co">#&gt;  4 -0.700   -0.700 1986-12-24     4 Subject</span>
<span class="co">#&gt;  5 -0.00932 -0.262 1987-07-17     5 Subject</span>
<span class="co">#&gt;  6 -0.624    0.272 1974-01-31     6 Subject</span>
<span class="co">#&gt;  7  0.296   -0.401 1988-06-05     7 Subject</span>
<span class="co">#&gt;  8  0.607   -0.418 1975-01-01     8 Subject</span>
<span class="co">#&gt;  9 -0.0141  -0.708 1985-09-21     9 Subject</span>
<span class="co">#&gt; 10 -0.557    0.561 1971-08-03    10 Subject</span>
<span class="co">#&gt; # ... with 157 more rows</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`BEF Spatial-Temporal Data`</span>
<span class="co">#&gt; # A tibble: 55 x 6</span>
<span class="co">#&gt;         x       y date_open  date_close    ID class      </span>
<span class="co">#&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;     &lt;int&gt; &lt;chr&gt;      </span>
<span class="co">#&gt;  1  0.624  0.916  1969-05-14 NA             1 Coffee_Shop</span>
<span class="co">#&gt;  2 -0.351 -0.796  1963-10-23 NA             2 Coffee_Shop</span>
<span class="co">#&gt;  3  0.893 -0.839  1960-09-12 NA             3 Coffee_Shop</span>
<span class="co">#&gt;  4  0.199 -0.140  1965-04-20 NA             4 Coffee_Shop</span>
<span class="co">#&gt;  5 -0.822  0.841  1962-06-28 NA             5 Coffee_Shop</span>
<span class="co">#&gt;  6 -0.673 -0.549  1968-02-01 NA             6 Coffee_Shop</span>
<span class="co">#&gt;  7  0.177  0.0337 1963-10-15 NA             7 Coffee_Shop</span>
<span class="co">#&gt;  8  0.364 -0.404  1963-12-30 NA             8 Coffee_Shop</span>
<span class="co">#&gt;  9  0.430  0.812  1968-10-09 NA             9 Coffee_Shop</span>
<span class="co">#&gt; 10 -0.383 -0.621  1961-05-18 2002-09-23    10 Coffee_Shop</span>
<span class="co">#&gt; # ... with 45 more rows</span></code></pre></div>
<p>The third and final dataset involves the subject specific data and the dates at which the measurements were taken.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subj_fdata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(ID)
<span class="co">#&gt; # A tibble: 291 x 7</span>
<span class="co">#&gt;       ID   sex DOB        Income measure_date   Age measure_ID</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;date&gt;      &lt;dbl&gt; &lt;date&gt;       &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1     1     1 1956-08-11   99.2 2000-02-19    43.6          1</span>
<span class="co">#&gt;  2     1     1 1956-08-11  196.  2001-07-20    45.0          2</span>
<span class="co">#&gt;  3     2     0 1953-09-23   62.6 2000-03-20    46.5          1</span>
<span class="co">#&gt;  4     2     0 1953-09-23  155.  2001-12-06    48.2          2</span>
<span class="co">#&gt;  5     3     1 1968-10-01   21.8 2000-03-10    31.5          1</span>
<span class="co">#&gt;  6     3     1 1968-10-01  117.  2002-07-02    33.8          2</span>
<span class="co">#&gt;  7     4     1 1954-06-01   89.9 2000-10-11    46.4          1</span>
<span class="co">#&gt;  8     4     1 1954-06-01  145.  2002-01-07    47.6          2</span>
<span class="co">#&gt;  9     5     1 1956-09-22   50.6 2000-10-14    44.1          1</span>
<span class="co">#&gt; 10     5     1 1956-09-22  107.  2003-06-28    46.8          2</span>
<span class="co">#&gt; # ... with 281 more rows</span></code></pre></div>
<p>In order to join these datasets, a new ID has to be created to associate the spatial-temporal data with a specific measurement date. We create this ID to include all spatial data up to and including the measurement date for each subject. Note that for subjects one and two there are two rows, corresponding to the two measurements. In contrast, subject nine has four rows, and two of them will be removed, so that the first measurement is associated with the subjects move in 1991. Note that any subject associated with a given measurement ID will also be associated with any subsequent measurement ID - this is is because the STAP model assumes exposure is relevant at each measurement.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subj_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(subj_fdata,<span class="dt">by=</span><span class="st">"ID"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(ID <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>))
<span class="co">#&gt; # A tibble: 8 x 11</span>
<span class="co">#&gt;         x      y date          ID class     sex DOB        Income</span>
<span class="co">#&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;date&gt;     &lt;int&gt; &lt;chr&gt;   &lt;int&gt; &lt;date&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 -0.701  -0.412 1974-05-11     1 Subject     1 1956-08-11   99.2</span>
<span class="co">#&gt; 2 -0.701  -0.412 1974-05-11     1 Subject     1 1956-08-11  196. </span>
<span class="co">#&gt; 3 -0.415   0.622 1976-03-04     2 Subject     0 1953-09-23   62.6</span>
<span class="co">#&gt; 4 -0.415   0.622 1976-03-04     2 Subject     0 1953-09-23  155. </span>
<span class="co">#&gt; 5 -0.0141 -0.708 1985-09-21     9 Subject     1 1966-04-06   66.8</span>
<span class="co">#&gt; 6 -0.0141 -0.708 1985-09-21     9 Subject     1 1966-04-06  129. </span>
<span class="co">#&gt; 7  0.315  -0.145 1991-11-14     9 Subject     1 1966-04-06   66.8</span>
<span class="co">#&gt; 8  0.315  -0.145 1991-11-14     9 Subject     1 1966-04-06  129. </span>
<span class="co">#&gt; # ... with 3 more variables: measure_date &lt;date&gt;, Age &lt;dbl&gt;,</span>
<span class="co">#&gt; #   measure_ID &lt;dbl&gt;</span></code></pre></div>
<p>Here we can see the effect of a store closing (BEF_ID 10) and a subject moving (subj_ID 9) on the data structure. Note that first row’s time is ~25.8 years which reflects the time spent since the <em>subject</em> first moved to their location. Since neither the subject nor the business moves by the subject’s second measurement in July of 2001, we see that the distances betwen subject 1 and Coffee Shop 1 stay constant, and the time increases according to the difference in measurement date, only.</p>
<p>In contrast, we see the effect of a subject moving for subj_ID 9. Here (s)he has twice as many measurements to show her/his exposure to the same coffee shop at the different locations where subj 9 lived. This is shown most evidently in the constant exposure for for coffee shops at the 1985 location for subject 9. Since subject 9 moved after ~6 years, and coffee shop 1 hadn’t closed at that time, subject 9 only has 6 years of exposure to that coffee shop at that distance. Following this we can see a steadily increasing exposure until the coffee shop closes in 2002, roughly a year before the subject’s second measurement in ’03.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">td_data  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(subj_ID <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">9</span>),bef_ID<span class="op">%in%</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(subj_ID,measure_ID,bef_ID)
<span class="co">#&gt; # A tibble: 12 x 10</span>
<span class="co">#&gt;    subj_ID measure_ID bef_ID measure_date date_open  date_close date      </span>
<span class="co">#&gt;      &lt;int&gt;      &lt;dbl&gt;  &lt;int&gt; &lt;date&gt;       &lt;date&gt;     &lt;date&gt;     &lt;date&gt;    </span>
<span class="co">#&gt;  1       1          1      1 2000-02-19   1969-05-14 NA         1974-05-11</span>
<span class="co">#&gt;  2       1          1     10 2000-02-19   1961-05-18 2002-09-23 1974-05-11</span>
<span class="co">#&gt;  3       1          2      1 2001-07-20   1969-05-14 NA         1974-05-11</span>
<span class="co">#&gt;  4       1          2     10 2001-07-20   1961-05-18 2002-09-23 1974-05-11</span>
<span class="co">#&gt;  5       9          1      1 2000-03-14   1969-05-14 NA         1985-09-21</span>
<span class="co">#&gt;  6       9          1      1 2000-03-14   1969-05-14 NA         1991-11-14</span>
<span class="co">#&gt;  7       9          1     10 2000-03-14   1961-05-18 2002-09-23 1985-09-21</span>
<span class="co">#&gt;  8       9          1     10 2000-03-14   1961-05-18 2002-09-23 1991-11-14</span>
<span class="co">#&gt;  9       9          2      1 2003-01-25   1969-05-14 NA         1985-09-21</span>
<span class="co">#&gt; 10       9          2      1 2003-01-25   1969-05-14 NA         1991-11-14</span>
<span class="co">#&gt; 11       9          2     10 2003-01-25   1961-05-18 2002-09-23 1985-09-21</span>
<span class="co">#&gt; 12       9          2     10 2003-01-25   1961-05-18 2002-09-23 1991-11-14</span>
<span class="co">#&gt; # ... with 3 more variables: class &lt;chr&gt;, dist &lt;dbl&gt;, time &lt;time&gt;</span></code></pre></div>
<p>If we were to assume a simple model</p>
<p><span class="math display">\[
E[Y_{ij}|b_i] = \alpha + Z_1\delta_{Income} + Z_{2}\delta_{sex} + Z_{3}\delta_{Age} + X(\theta_s,\theta_t)\beta_{Coffee} + b_i
\]</span> Where <span class="math display">\[
X(\theta_s,\theta_t) = \big(\sum_{d\in\mathcal{D}} w_d(\frac{d}{\theta_s}) w_t(\frac{t}{\theta_t}) \big )
\]</span></p>
<p>and simulate it under the following fixed values</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alpha &lt;-<span class="st"> </span><span class="dv">22</span>
delta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Income =</span> <span class="op">-</span>.<span class="dv">35</span>,<span class="dt">sex =</span> <span class="fl">1.1</span>, <span class="dt">Age =</span> <span class="fl">1.2</span>)
beta &lt;-<span class="st"> </span>.<span class="dv">5</span>
theta_s &lt;-<span class="st"> </span>.<span class="dv">8</span>
theta_t &lt;-<span class="st"> </span><span class="dv">34</span>
sigma &lt;-<span class="st"> </span><span class="dv">2</span>
tau &lt;-<span class="st"> </span><span class="fl">1.5</span>
d &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">max</span>(td_data<span class="op">$</span>dist), <span class="dt">by =</span> <span class="fl">0.01</span>)
t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">as.numeric</span>(<span class="kw">max</span>(td_data<span class="op">$</span>time)), <span class="dt">by =</span> <span class="fl">0.01</span>)
w_s &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erfc</a></span>(d<span class="op">/</span>theta_s)
w_t &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erf</a></span>(t<span class="op">/</span>theta_t)
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(d,w_s,<span class="dt">type=</span><span class="st">'l'</span>, <span class="dt">main=</span><span class="st">"Spatial Decay"</span>)
<span class="kw">plot</span>(t,w_t,<span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">main =</span> <span class="st">"Temporal Accumulation"</span>,<span class="dt">xlab=</span><span class="st">'years'</span>)</code></pre></div>
<p><img src="longitudinal-I_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>This will result in the following exposure densities</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">td_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(subj_ID,measure_ID,date) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="dt">dist_exposure =</span> <span class="kw">sum</span>(pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erfc</a></span>(dist<span class="op">/</span>theta_s)),
              <span class="dt">time_exposure =</span> <span class="kw">sum</span>(pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erf</a></span>(<span class="kw">as.numeric</span>(time)<span class="op">/</span>theta_t)),
              <span class="dt">total_exposure =</span> <span class="kw">sum</span>(pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erfc</a></span>(dist<span class="op">/</span>theta_s) <span class="op">*</span><span class="st"> </span>pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erfc</a></span>(<span class="kw">as.numeric</span>(time)<span class="op">/</span>theta_t)) ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/gather">gather</a></span>(<span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">contains</a></span>(<span class="st">"Exposure"</span>),<span class="dt">key=</span><span class="st">"Exposure_Type"</span>,<span class="dt">value =</span> <span class="st">"Exposure"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(Exposure_Type <span class="op">!=</span><span class="st"> "total_exposure"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>Exposure,<span class="dt">fill=</span>Exposure_Type)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_density">geom_density</a></span>(<span class="dt">alpha=</span><span class="fl">0.4</span>)  <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>()</code></pre></div>
<p><img src="longitudinal-I_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">td_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(subj_ID,measure_ID,date) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="dt">dist_exposure =</span> <span class="kw">sum</span>(pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erfc</a></span>(dist<span class="op">/</span>theta_s)),
              <span class="dt">time_exposure =</span> <span class="kw">sum</span>(pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erf</a></span>(<span class="kw">as.numeric</span>(time)<span class="op">/</span>theta_t)),
              <span class="dt">total_exposure =</span> <span class="kw">sum</span>(pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erfc</a></span>(dist<span class="op">/</span>theta_s) <span class="op">*</span><span class="st"> </span>pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erfc</a></span>(<span class="kw">as.numeric</span>(time)<span class="op">/</span>theta_t))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/gather">gather</a></span>(<span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">contains</a></span>(<span class="st">"Exposure"</span>),<span class="dt">key=</span><span class="st">"Exposure_Type"</span>,<span class="dt">value =</span> <span class="st">"Exposure"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(Exposure_Type <span class="op">==</span><span class="st"> "total_exposure"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>Exposure,<span class="dt">fill=</span>Exposure_Type)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_density">geom_density</a></span>()  <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>()</code></pre></div>
<p><img src="longitudinal-I_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Below we see that after scaling and centering, the average exposure is higher for the second measurement. This makes sense because we’d expect individuals temporal exposure to continue to accumulate after the first measurement.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Xs &lt;-<span class="st"> </span>td_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(subj_ID,measure_ID,date) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="dt">dist_exposure =</span> <span class="kw">sum</span>(pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erfc</a></span>(dist<span class="op">/</span>theta_s)),
              <span class="dt">time_exposure =</span> <span class="kw">sum</span>(pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erf</a></span>(<span class="kw">as.numeric</span>(time)<span class="op">/</span>theta_t)),
              <span class="dt">total_exposure =</span> <span class="kw">sum</span>(pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erfc</a></span>(dist<span class="op">/</span>theta_s) <span class="op">*</span><span class="st"> </span>pracma<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pracma/topics/erfz">erfc</a></span>(<span class="kw">as.numeric</span>(time)<span class="op">/</span>theta_t)) ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">as_data_frame</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/gather">gather</a></span>(<span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">contains</a></span>(<span class="st">"Exposure"</span>),<span class="dt">key=</span><span class="st">'Exposure_Type'</span>,<span class="dt">value=</span><span class="st">"Exposure"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(Exposure_Type <span class="op">==</span><span class="st"> "total_exposure"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(subj_ID,measure_ID) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="dt">Exposure =</span> <span class="kw">sum</span>(Exposure)) <span class="op">%&gt;%</span><span class="st">  </span>## sum multiple dates (moves) to a single outcome measurement
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/spread">spread</a></span>(measure_ID,Exposure) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">j_1 =</span> (<span class="st">`</span><span class="dt">1</span><span class="st">`</span> <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(.<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(.<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>),
           <span class="dt">j_2 =</span> (<span class="st">`</span><span class="dt">2</span><span class="st">`</span> <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(.<span class="op">$</span><span class="st">`</span><span class="dt">2</span><span class="st">`</span>,<span class="dt">na.rm=</span>T)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(.<span class="op">$</span><span class="st">`</span><span class="dt">2</span><span class="st">`</span>,<span class="dt">na.rm=</span>T)) <span class="op">%&gt;%</span><span class="st"> </span>## Needed because some subjects missing for second measurement
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(subj_ID,j_<span class="dv">1</span>,j_<span class="dv">2</span>)

subj_fdata &lt;-<span class="st"> </span>subj_fdata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(Xs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/gather">gather</a></span>(j_<span class="dv">1</span>,j_<span class="dv">2</span>,<span class="dt">key =</span> <span class="st">"measure_ID"</span>,<span class="dt">value=</span><span class="st">"Coffee_Shop"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">measure_ID =</span> (measure_ID<span class="op">==</span><span class="st">"j_2"</span>)<span class="op">*</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>),
                                       <span class="dt">by=</span><span class="kw">c</span>(<span class="st">"ID"</span>=<span class="st">"subj_ID"</span>,<span class="st">"measure_ID"</span>))

subj_fdata &lt;-<span class="st"> </span>subj_fdata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(<span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">data_frame</a></span>(<span class="dt">ID=</span><span class="dv">1</span><span class="op">:</span>num_subj_init,
                                                  <span class="dt">ran_int =</span> <span class="kw">rnorm</span>(<span class="dt">n=</span>num_subj_init,<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> tau)))
<span class="co">#&gt; Joining, by = "ID"</span>

Xs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/gather">gather</a></span>(j_<span class="dv">1</span>,j_<span class="dv">2</span>,<span class="dt">key=</span><span class="st">"measurement"</span>,<span class="dt">value=</span><span class="st">"exposure"</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>exposure,<span class="dt">fill=</span>measurement)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_density">geom_density</a></span>(<span class="dt">alpha=</span><span class="fl">0.3</span>)  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>()</code></pre></div>
<p><img src="longitudinal-I_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lme_inf &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/lme4/topics/modular">glFormula</a></span>(<span class="dt">formula =</span>  measure_ID <span class="op">~</span>
<span class="st">                               </span><span class="kw">I</span>((Income<span class="op">-</span><span class="kw">mean</span>(Income))<span class="op">/</span><span class="kw">sd</span>(Income) ) <span class="op">+</span><span class="st"> </span>
<span class="st">                               </span>sex <span class="op">+</span><span class="st"> </span>
<span class="st">                               </span><span class="kw">I</span>((Age <span class="op">-</span><span class="kw">mean</span>(Age))<span class="op">/</span><span class="kw">sd</span>(Age)) <span class="op">+</span><span class="st"> </span>
<span class="st">                               </span>Coffee_Shop <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>ID),
                     <span class="dt">data =</span> subj_fdata,<span class="dt">family =</span> <span class="kw">gaussian</span>(<span class="dt">link=</span><span class="st">'identity'</span>))
Z &lt;-<span class="st"> </span>lme_inf<span class="op">$</span>X
y &lt;-<span class="st"> </span>Z <span class="op">%*%</span><span class="st"> </span><span class="kw">c</span>(alpha,delta,beta) <span class="op">+</span><span class="st"> </span>subj_fdata<span class="op">$</span>ran_int <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(Z),<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd =</span> sigma)
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">hist</span>(y[<span class="dv">1</span><span class="op">:</span>num_subj_init], <span class="dt">xlab =</span> <span class="st">"BMI"</span>,<span class="dt">main=</span><span class="st">"First Measurement"</span>)
<span class="kw">hist</span>(y[num_subj_init<span class="op">+</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(y)], <span class="dt">xlab=</span> <span class="st">"BMI"</span>, <span class="dt">main=</span><span class="st">"Second Measurement"</span>)</code></pre></div>
<p><img src="longitudinal-I_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subj_fdata &lt;-<span class="st"> </span>subj_fdata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(<span class="kw">cbind</span>(lme_inf<span class="op">$</span>fr,y),<span class="dt">by=</span><span class="kw">c</span>(<span class="st">"ID"</span>,<span class="st">"measure_ID"</span>))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">sex =</span> sex.x, <span class="dt">Coffee_Shop=</span> Coffee_Shop.x,<span class="dt">subj_ID=</span>ID,
           <span class="dt">centered_income =</span> <span class="st">`</span><span class="dt">I((Income - mean(Income))/sd(Income))</span><span class="st">`</span>,
           <span class="dt">centered_age =</span> <span class="st">`</span><span class="dt">I((Age - mean(Age))/sd(Age))</span><span class="st">`</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>Coffee_Shop.x,<span class="op">-</span>sex.x,<span class="op">-</span>sex.y,
           <span class="op">-</span>ID,<span class="st">`</span><span class="dt">I((Age - mean(Age))/sd(Age))</span><span class="st">`</span>,
           <span class="st">`</span><span class="dt">I((Income - mean(Income))/sd(Income))</span><span class="st">`</span>)</code></pre></div>
<p>The final datasets passed to the <code>stap_glmer</code> function will then be the subject specific data, and the td data above containing the subject ID, the BEF class label and the distance or time. These are displayed below</p>
<pre><code>#&gt; $subject_data
#&gt; # A tibble: 291 x 8
#&gt;    subj_ID Income measure_ID   Age ran_int     y   sex Coffee_Shop
#&gt;      &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;       &lt;dbl&gt;
#&gt;  1       1   99.2          1  43.6   0.148  24.6     1      -0.509
#&gt;  2       2   62.6          1  46.5   0.243  23.9     0      -0.611
#&gt;  3       3   21.8          1  31.5   0.480  18.6     1      -0.686
#&gt;  4       4   89.9          1  46.4   1.03   25.8     1       0.353
#&gt;  5       5   50.6          1  44.1   1.01   24.4     1       0.807
#&gt;  6       6   19.5          1  40.7  -0.184  23.1     1      -0.722
#&gt;  7       7   67.2          1  46.7   0.127  27.1     1       0.789
#&gt;  8       8   79.1          1  41.6  -0.387  21.8     0      -0.571
#&gt;  9       9   66.8          1  34.0  -0.345  24.4     1       4.12 
#&gt; 10      10   67.2          1  48.9  -1.79   22.5     0      -0.883
#&gt; # ... with 281 more rows
#&gt; 
#&gt; $distance_data
#&gt; # A tibble: 17,875 x 6
#&gt;    subj_ID measure_ID date       bef_ID class        dist
#&gt;      &lt;int&gt;      &lt;dbl&gt; &lt;date&gt;      &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
#&gt;  1       1          1 1974-05-11      1 Coffee_Shop  1.88
#&gt;  2       2          1 1976-03-04      1 Coffee_Shop  1.08
#&gt;  3       3          1 1976-04-15      1 Coffee_Shop  1.98
#&gt;  4       4          1 1986-12-24      1 Coffee_Shop  2.09
#&gt;  5       5          1 1987-07-17      1 Coffee_Shop  1.34
#&gt;  6       6          1 1974-01-31      1 Coffee_Shop  1.40
#&gt;  7       7          1 1988-06-05      1 Coffee_Shop  1.36
#&gt;  8       8          1 1975-01-01      1 Coffee_Shop  1.33
#&gt;  9       9          1 1985-09-21      1 Coffee_Shop  1.74
#&gt; 10       9          1 1991-11-14      1 Coffee_Shop  1.10
#&gt; # ... with 17,865 more rows
#&gt; 
#&gt; $time_data
#&gt; # A tibble: 17,875 x 6
#&gt;    subj_ID measure_ID date       bef_ID class       time            
#&gt;      &lt;int&gt;      &lt;dbl&gt; &lt;date&gt;      &lt;int&gt; &lt;chr&gt;       &lt;time&gt;          
#&gt;  1       1          1 1974-05-11      1 Coffee_Shop 25.7945205479452
#&gt;  2       2          1 1976-03-04      1 Coffee_Shop 24.0602739726027
#&gt;  3       3          1 1976-04-15      1 Coffee_Shop 23.9178082191781
#&gt;  4       4          1 1986-12-24      1 Coffee_Shop 13.8082191780822
#&gt;  5       5          1 1987-07-17      1 Coffee_Shop 13.2547945205479
#&gt;  6       6          1 1974-01-31      1 Coffee_Shop 26.6904109589041
#&gt;  7       7          1 1988-06-05      1 Coffee_Shop 12.5205479452055
#&gt;  8       8          1 1975-01-01      1 Coffee_Shop 25.3780821917808
#&gt;  9       9          1 1985-09-21      1 Coffee_Shop 6.15068493150685
#&gt; 10       9          1 1991-11-14      1 Coffee_Shop 8.33698630136986
#&gt; # ... with 17,865 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/stap_glmer.html">stap_glmer</a></span>(y <span class="op">~</span><span class="st"> </span>centered_income <span class="op">+</span><span class="st">  </span>sex <span class="op">+</span><span class="st"> </span>centered_age <span class="op">+</span><span class="st"> </span><span class="kw">stap</span>(Coffee_Shop) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>subj_ID),
                  <span class="dt">family =</span> <span class="kw">gaussian</span>(<span class="dt">link=</span><span class="st">'identity'</span>),
                  <span class="dt">subject_data =</span> homog_longitudinal_subject_data,
                  <span class="dt">distance_data =</span> homog_longitudinal_distance_data,
                  <span class="dt">time_data =</span> homog_longitudinal_time_data,
                  <span class="dt">subject_ID =</span> <span class="st">'subj_ID'</span>,<span class="dt">measure_ID =</span> <span class="st">'measure_ID'</span>,
                  <span class="dt">prior_intercept =</span> <span class="kw"><a href="../reference/priors.html">normal</a></span>(<span class="dt">location =</span> <span class="dv">25</span>, <span class="dt">scale =</span> <span class="dv">4</span>, <span class="dt">autoscale =</span> F),
                  <span class="dt">prior =</span> <span class="kw"><a href="../reference/priors.html">normal</a></span>(<span class="dt">location =</span> <span class="dv">0</span>, <span class="dt">scale =</span> <span class="dv">4</span>,<span class="dt">autoscale=</span>F),
                  <span class="dt">prior_stap =</span> <span class="kw"><a href="../reference/priors.html">normal</a></span>(<span class="dt">location =</span> <span class="dv">0</span>, <span class="dt">scale =</span> <span class="dv">4</span>),
                  <span class="dt">prior_theta =</span> <span class="kw"><a href="../reference/priors.html">log_normal</a></span>(<span class="dt">location =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="dv">2</span>),
                  <span class="dt">max_distance =</span> <span class="dv">3</span>, <span class="dt">max_time =</span> <span class="dv">50</span>,
                  <span class="dt">chains =</span> <span class="dv">3</span>,
                  <span class="dt">iter =</span> <span class="fl">1E3</span>,
                  <span class="dt">cores =</span> <span class="dv">3</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/posterior_interval.stapreg.html">posterior_interval</a></span>(fit)
<span class="co">#&gt;                                                 5%        95%</span>
<span class="co">#&gt; (Intercept)                            21.88554745 22.6233155</span>
<span class="co">#&gt; centered_income                        -0.64233872 -0.1224059</span>
<span class="co">#&gt; sex                                    -0.03986070  0.9040435</span>
<span class="co">#&gt; centered_age                            1.03251487  1.5141293</span>
<span class="co">#&gt; Coffee_Shop                             0.07807833  0.6254521</span>
<span class="co">#&gt; Coffee_Shop_spatial_scale               0.25876330 14.0449708</span>
<span class="co">#&gt; Coffee_Shop_temporal_scale              0.06963218 53.0675458</span>
<span class="co">#&gt; b[(Intercept) subj_ID:1]               -4.96322187  5.5990324</span>
<span class="co">#&gt; b[(Intercept) subj_ID:2]               -4.93589897  5.3478097</span>
<span class="co">#&gt; b[(Intercept) subj_ID:3]               -5.69152371  4.4727447</span>
<span class="co">#&gt; b[(Intercept) subj_ID:4]               -4.54026932  5.0335067</span>
<span class="co">#&gt; b[(Intercept) subj_ID:5]               -5.16406708  5.1119459</span>
<span class="co">#&gt; b[(Intercept) subj_ID:6]               -5.28928620  5.0707782</span>
<span class="co">#&gt; b[(Intercept) subj_ID:7]               -5.90072882  5.1742978</span>
<span class="co">#&gt; b[(Intercept) subj_ID:8]               -5.00062008  5.1101471</span>
<span class="co">#&gt; b[(Intercept) subj_ID:9]               -5.86695098  5.1625244</span>
<span class="co">#&gt; b[(Intercept) subj_ID:10]              -5.45985746  5.0803286</span>
<span class="co">#&gt; b[(Intercept) subj_ID:11]              -4.51449694  4.9880320</span>
<span class="co">#&gt; b[(Intercept) subj_ID:12]              -5.10805325  5.3369563</span>
<span class="co">#&gt; b[(Intercept) subj_ID:13]              -4.62347005  5.2494162</span>
<span class="co">#&gt; b[(Intercept) subj_ID:14]              -5.54774788  5.5129070</span>
<span class="co">#&gt; b[(Intercept) subj_ID:15]              -4.86902440  4.8287890</span>
<span class="co">#&gt; b[(Intercept) subj_ID:16]              -4.92189790  5.1441237</span>
<span class="co">#&gt; b[(Intercept) subj_ID:17]              -5.53610071  5.2573693</span>
<span class="co">#&gt; b[(Intercept) subj_ID:18]              -5.92999734  5.3460856</span>
<span class="co">#&gt; b[(Intercept) subj_ID:19]              -5.54232636  5.9998067</span>
<span class="co">#&gt; b[(Intercept) subj_ID:20]              -6.38257021  4.6633651</span>
<span class="co">#&gt; b[(Intercept) subj_ID:21]              -5.11020098  4.8052279</span>
<span class="co">#&gt; b[(Intercept) subj_ID:22]              -5.51755894  4.9571013</span>
<span class="co">#&gt; b[(Intercept) subj_ID:23]              -4.50086917  5.1766456</span>
<span class="co">#&gt; b[(Intercept) subj_ID:24]              -5.43672453  5.2427440</span>
<span class="co">#&gt; b[(Intercept) subj_ID:25]              -5.09295667  4.9050728</span>
<span class="co">#&gt; b[(Intercept) subj_ID:26]              -5.03549026  4.9290156</span>
<span class="co">#&gt; b[(Intercept) subj_ID:27]              -5.14323554  5.1445658</span>
<span class="co">#&gt; b[(Intercept) subj_ID:28]              -5.76044086  5.8009374</span>
<span class="co">#&gt; b[(Intercept) subj_ID:29]              -5.25615106  5.8666394</span>
<span class="co">#&gt; b[(Intercept) subj_ID:30]              -4.25210568  5.5171362</span>
<span class="co">#&gt; b[(Intercept) subj_ID:31]              -4.75417491  5.7343885</span>
<span class="co">#&gt; b[(Intercept) subj_ID:32]              -5.99080549  4.7333996</span>
<span class="co">#&gt; b[(Intercept) subj_ID:33]              -4.99002079  5.7735570</span>
<span class="co">#&gt; b[(Intercept) subj_ID:34]              -5.13011321  5.4524030</span>
<span class="co">#&gt; b[(Intercept) subj_ID:35]              -5.57440622  5.3617777</span>
<span class="co">#&gt; b[(Intercept) subj_ID:36]              -5.06177564  5.4368430</span>
<span class="co">#&gt; b[(Intercept) subj_ID:37]              -5.00729441  4.4130459</span>
<span class="co">#&gt; b[(Intercept) subj_ID:38]              -4.94252700  5.6955903</span>
<span class="co">#&gt; b[(Intercept) subj_ID:39]              -5.18933528  5.2361153</span>
<span class="co">#&gt; b[(Intercept) subj_ID:40]              -6.40310744  5.1850450</span>
<span class="co">#&gt; b[(Intercept) subj_ID:41]              -4.70678573  4.7547548</span>
<span class="co">#&gt; b[(Intercept) subj_ID:42]              -5.14683602  5.3007572</span>
<span class="co">#&gt; b[(Intercept) subj_ID:43]              -5.80096335  4.8459462</span>
<span class="co">#&gt; b[(Intercept) subj_ID:44]              -5.45005341  5.2736075</span>
<span class="co">#&gt; b[(Intercept) subj_ID:45]              -5.26892659  4.8641547</span>
<span class="co">#&gt; b[(Intercept) subj_ID:46]              -5.26041251  5.3794659</span>
<span class="co">#&gt; b[(Intercept) subj_ID:47]              -5.17354855  4.9097435</span>
<span class="co">#&gt; b[(Intercept) subj_ID:48]              -4.85634407  5.1837378</span>
<span class="co">#&gt; b[(Intercept) subj_ID:49]              -4.81394643  5.7983528</span>
<span class="co">#&gt; b[(Intercept) subj_ID:50]              -5.45194500  5.1651898</span>
<span class="co">#&gt; b[(Intercept) subj_ID:51]              -5.17332095  5.4038451</span>
<span class="co">#&gt; b[(Intercept) subj_ID:52]              -5.18199224  5.1544905</span>
<span class="co">#&gt; b[(Intercept) subj_ID:53]              -5.05735415  5.3322164</span>
<span class="co">#&gt; b[(Intercept) subj_ID:54]              -4.83040754  5.7830691</span>
<span class="co">#&gt; b[(Intercept) subj_ID:55]              -5.47913332  5.2696659</span>
<span class="co">#&gt; b[(Intercept) subj_ID:56]              -5.16133025  5.0374079</span>
<span class="co">#&gt; b[(Intercept) subj_ID:57]              -5.35418886  5.0965604</span>
<span class="co">#&gt; b[(Intercept) subj_ID:58]              -5.53637762  4.9328656</span>
<span class="co">#&gt; b[(Intercept) subj_ID:59]              -4.86375706  4.9714354</span>
<span class="co">#&gt; b[(Intercept) subj_ID:60]              -5.78065365  4.8395013</span>
<span class="co">#&gt; b[(Intercept) subj_ID:61]              -5.72272666  5.1984863</span>
<span class="co">#&gt; b[(Intercept) subj_ID:62]              -5.23578698  5.1212687</span>
<span class="co">#&gt; b[(Intercept) subj_ID:63]              -5.34083556  5.3951383</span>
<span class="co">#&gt; b[(Intercept) subj_ID:64]              -4.94782937  5.7735327</span>
<span class="co">#&gt; b[(Intercept) subj_ID:65]              -5.73843609  5.4409662</span>
<span class="co">#&gt; b[(Intercept) subj_ID:66]              -5.36083018  5.3543711</span>
<span class="co">#&gt; b[(Intercept) subj_ID:67]              -5.07956646  5.3130502</span>
<span class="co">#&gt; b[(Intercept) subj_ID:68]              -6.02657698  4.7228548</span>
<span class="co">#&gt; b[(Intercept) subj_ID:69]              -4.62863385  5.7530693</span>
<span class="co">#&gt; b[(Intercept) subj_ID:70]              -4.72456428  5.2209693</span>
<span class="co">#&gt; b[(Intercept) subj_ID:71]              -5.39950560  5.0832602</span>
<span class="co">#&gt; b[(Intercept) subj_ID:72]              -5.24772674  4.8808625</span>
<span class="co">#&gt; b[(Intercept) subj_ID:73]              -4.74007972  5.4568565</span>
<span class="co">#&gt; b[(Intercept) subj_ID:74]              -5.10388086  4.7745761</span>
<span class="co">#&gt; b[(Intercept) subj_ID:75]              -5.10808553  4.4981188</span>
<span class="co">#&gt; b[(Intercept) subj_ID:76]              -5.46363459  5.3162685</span>
<span class="co">#&gt; b[(Intercept) subj_ID:77]              -4.56060277  5.0070822</span>
<span class="co">#&gt; b[(Intercept) subj_ID:78]              -5.12434162  4.9165755</span>
<span class="co">#&gt; b[(Intercept) subj_ID:79]              -5.68880466  4.3414238</span>
<span class="co">#&gt; b[(Intercept) subj_ID:80]              -5.14085484  5.0300807</span>
<span class="co">#&gt; b[(Intercept) subj_ID:81]              -5.25100643  5.3227732</span>
<span class="co">#&gt; b[(Intercept) subj_ID:82]              -4.85114733  4.9440596</span>
<span class="co">#&gt; b[(Intercept) subj_ID:83]              -5.68357510  5.4396417</span>
<span class="co">#&gt; b[(Intercept) subj_ID:84]              -5.01395712  4.3439844</span>
<span class="co">#&gt; b[(Intercept) subj_ID:85]              -5.31386162  5.9245717</span>
<span class="co">#&gt; b[(Intercept) subj_ID:86]              -5.37526823  4.7035875</span>
<span class="co">#&gt; b[(Intercept) subj_ID:87]              -5.53963942  5.4587454</span>
<span class="co">#&gt; b[(Intercept) subj_ID:88]              -5.09570355  6.1992526</span>
<span class="co">#&gt; b[(Intercept) subj_ID:89]              -5.05555443  5.1988944</span>
<span class="co">#&gt; b[(Intercept) subj_ID:90]              -4.97767765  4.8633119</span>
<span class="co">#&gt; b[(Intercept) subj_ID:91]              -4.92543508  5.1120694</span>
<span class="co">#&gt; b[(Intercept) subj_ID:92]              -4.89363294  4.7826000</span>
<span class="co">#&gt; b[(Intercept) subj_ID:93]              -5.41285812  5.0450782</span>
<span class="co">#&gt; b[(Intercept) subj_ID:94]              -4.57355761  5.7494308</span>
<span class="co">#&gt; b[(Intercept) subj_ID:95]              -5.85188936  5.4755260</span>
<span class="co">#&gt; b[(Intercept) subj_ID:96]              -5.30428705  5.2196325</span>
<span class="co">#&gt; b[(Intercept) subj_ID:97]              -4.94811120  5.2594030</span>
<span class="co">#&gt; b[(Intercept) subj_ID:98]              -5.62601240  5.7868221</span>
<span class="co">#&gt; b[(Intercept) subj_ID:99]              -6.02132899  5.1517439</span>
<span class="co">#&gt; b[(Intercept) subj_ID:100]             -4.74059284  5.3973277</span>
<span class="co">#&gt; b[(Intercept) subj_ID:101]             -4.84842665  5.3568919</span>
<span class="co">#&gt; b[(Intercept) subj_ID:102]             -4.72450212  4.9327281</span>
<span class="co">#&gt; b[(Intercept) subj_ID:103]             -5.20406845  4.4011045</span>
<span class="co">#&gt; b[(Intercept) subj_ID:104]             -5.19488643  4.7516814</span>
<span class="co">#&gt; b[(Intercept) subj_ID:105]             -4.69577062  5.4386631</span>
<span class="co">#&gt; b[(Intercept) subj_ID:106]             -4.75798124  5.9179910</span>
<span class="co">#&gt; b[(Intercept) subj_ID:107]             -5.07788110  5.1228297</span>
<span class="co">#&gt; b[(Intercept) subj_ID:108]             -4.74074588  5.6322575</span>
<span class="co">#&gt; b[(Intercept) subj_ID:109]             -5.43257911  5.2057118</span>
<span class="co">#&gt; b[(Intercept) subj_ID:110]             -4.69844173  4.9549831</span>
<span class="co">#&gt; b[(Intercept) subj_ID:111]             -4.95358062  5.5806308</span>
<span class="co">#&gt; b[(Intercept) subj_ID:112]             -5.55774184  5.0545401</span>
<span class="co">#&gt; b[(Intercept) subj_ID:113]             -4.73978572  5.1380201</span>
<span class="co">#&gt; b[(Intercept) subj_ID:114]             -5.31033331  5.7291126</span>
<span class="co">#&gt; b[(Intercept) subj_ID:115]             -5.11879988  4.8198142</span>
<span class="co">#&gt; b[(Intercept) subj_ID:116]             -5.07747530  5.2404052</span>
<span class="co">#&gt; b[(Intercept) subj_ID:117]             -5.46913614  5.1084996</span>
<span class="co">#&gt; b[(Intercept) subj_ID:118]             -4.69951974  5.4250050</span>
<span class="co">#&gt; b[(Intercept) subj_ID:119]             -5.15733572  4.7366369</span>
<span class="co">#&gt; b[(Intercept) subj_ID:120]             -4.83802121  5.8379892</span>
<span class="co">#&gt; b[(Intercept) subj_ID:121]             -6.15364484  4.7341750</span>
<span class="co">#&gt; b[(Intercept) subj_ID:122]             -5.06471881  5.1712567</span>
<span class="co">#&gt; b[(Intercept) subj_ID:123]             -5.48711180  5.4169425</span>
<span class="co">#&gt; b[(Intercept) subj_ID:124]             -4.94854084  4.7465074</span>
<span class="co">#&gt; b[(Intercept) subj_ID:125]             -4.88863355  5.2077207</span>
<span class="co">#&gt; b[(Intercept) subj_ID:126]             -4.74803078  4.9542446</span>
<span class="co">#&gt; b[(Intercept) subj_ID:127]             -5.58364072  5.5595485</span>
<span class="co">#&gt; b[(Intercept) subj_ID:128]             -5.46268685  5.2260364</span>
<span class="co">#&gt; b[(Intercept) subj_ID:129]             -4.57581889  5.5537955</span>
<span class="co">#&gt; b[(Intercept) subj_ID:130]             -5.48681648  5.1472080</span>
<span class="co">#&gt; b[(Intercept) subj_ID:131]             -5.18650263  4.7321827</span>
<span class="co">#&gt; b[(Intercept) subj_ID:132]             -5.51774358  5.3909219</span>
<span class="co">#&gt; b[(Intercept) subj_ID:133]             -5.90369741  4.5685994</span>
<span class="co">#&gt; b[(Intercept) subj_ID:134]             -5.46355598  4.7494130</span>
<span class="co">#&gt; b[(Intercept) subj_ID:135]             -4.67730576  5.2945972</span>
<span class="co">#&gt; b[(Intercept) subj_ID:136]             -5.56867094  5.7651999</span>
<span class="co">#&gt; b[(Intercept) subj_ID:137]             -5.23769194  5.1957021</span>
<span class="co">#&gt; b[(Intercept) subj_ID:138]             -4.95988320  4.8818879</span>
<span class="co">#&gt; b[(Intercept) subj_ID:139]             -4.79498265  5.0690891</span>
<span class="co">#&gt; b[(Intercept) subj_ID:140]             -5.20532117  5.4517649</span>
<span class="co">#&gt; b[(Intercept) subj_ID:141]             -5.06923505  5.1656763</span>
<span class="co">#&gt; b[(Intercept) subj_ID:142]             -5.15489815  4.7346003</span>
<span class="co">#&gt; b[(Intercept) subj_ID:143]             -5.45677462  5.0584897</span>
<span class="co">#&gt; b[(Intercept) subj_ID:144]             -5.59822149  5.6031583</span>
<span class="co">#&gt; b[(Intercept) subj_ID:145]             -4.76493717  5.2745866</span>
<span class="co">#&gt; b[(Intercept) subj_ID:146]             -5.21173012  4.8814513</span>
<span class="co">#&gt; b[(Intercept) subj_ID:147]             -5.15697563  4.8604376</span>
<span class="co">#&gt; b[(Intercept) subj_ID:148]             -4.74182253  5.0728940</span>
<span class="co">#&gt; b[(Intercept) subj_ID:149]             -4.62259604  5.0989428</span>
<span class="co">#&gt; b[(Intercept) subj_ID:150]             -5.07515209  5.3828119</span>
<span class="co">#&gt; sigma                                   0.02612735 53.1634750</span>
<span class="co">#&gt; Sigma[subj_ID:(Intercept),(Intercept)]  2.42523997  2.7485745</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#data-structure-complexities">Data Structure Complexities</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Adam Peterson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
