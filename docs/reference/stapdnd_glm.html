<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian generalized spatial-temporal aggregated predictor(STAP) models via Stan — stapdnd_glm • rstap</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Bayesian generalized spatial-temporal aggregated predictor(STAP) models via Stan — stapdnd_glm" />

<meta property="og:description" content="Generalized linear modeling with spatial temporal aggregated predictors using
prior distributions for the coefficients, intercept, spatial-temporal scales, and auxiliary parameters." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstap</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Introduction.html">STAP Introduction</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian generalized spatial-temporal aggregated predictor(STAP) models via Stan</h1>
    
    <div class="hidden name"><code>stapdnd_glm.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Generalized linear modeling with spatial temporal aggregated predictors using
prior distributions for the coefficients, intercept, spatial-temporal scales, and auxiliary parameters.</p>
    
    </div>

    <pre class="usage"><span class='fu'>stapdnd_glm</span>(<span class='no'>formula</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>gaussian</span>(), <span class='kw'>subject_data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>distance_data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>time_data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>subject_ID</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>group_ID</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>subject_matrix</span>, <span class='no'>subject_n</span>, <span class='kw'>max_distance</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>max_time</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>weights</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(),
  <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(), <span class='kw'>prior_stap</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(),
  <span class='kw'>prior_theta</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>log_normal</a></span>(<span class='kw'>location</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>1L</span>),
  <span class='kw'>prior_aux</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>exponential</a></span>(), <span class='kw'>adapt_delta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>stapdnd_lm</span>(<span class='no'>formula</span>, <span class='kw'>subject_data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>distance_data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>time_data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>subject_ID</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>max_distance</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>max_time</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>weights</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(),
  <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(), <span class='kw'>prior_stap</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(),
  <span class='kw'>prior_theta</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>log_normal</a></span>(<span class='kw'>location</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>1L</span>),
  <span class='kw'>prior_aux</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>exponential</a></span>(), <span class='kw'>adapt_delta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>Same as for <code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code>. Note that in-formula transformations will not be passed ot the final design matrix. Covariates that have "scale" in their name are not advised as this text is parsed for in the final model fit.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Same as <code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code> for gaussian, binomial, and poisson families.</p></td>
    </tr>
    <tr>
      <th>subject_data</th>
      <td><p>a data.frame that contains data specific to the subject or subjects on whom the outcome is measured. Must contain one column that has the subject_ID  on which to join the distance and time_data</p></td>
    </tr>
    <tr>
      <th>distance_data</th>
      <td><p>a (minimum) three column data.frame that contains (1) an id_key (2) The sap/tap/stap features and (3) the distances between subject with a given id and the built environment feature in column (2), the distance column must be the only column of type "double" and the sap/tap/stap features must be specified in the dataframe exactly as they are in the formula.</p></td>
    </tr>
    <tr>
      <th>time_data</th>
      <td><p>same as distance_data except with time that the subject has been exposed to the built environment feature, instead of distance</p></td>
    </tr>
    <tr>
      <th>subject_ID</th>
      <td><p>name of column(s) to join on between subject_data and bef_data</p></td>
    </tr>
    <tr>
      <th>group_ID</th>
      <td><p>name of column(s0 to join on between subject_data and bef_data that indicate clustered or repeated measures</p></td>
    </tr>
    <tr>
      <th>subject_matrix</th>
      <td><p>binary matrix used to group patient observations</p></td>
    </tr>
    <tr>
      <th>subject_n</th>
      <td><p>matrix of the inverse of the number of observations each subject has</p></td>
    </tr>
    <tr>
      <th>max_distance</th>
      <td><p>the inclusion distance; upper bound for all elements of dists_crs</p></td>
    </tr>
    <tr>
      <th>max_time</th>
      <td><p>inclusion time; upper bound for all elements of times_crs</p></td>
    </tr>
    <tr>
      <th>offset, weights</th>
      <td><p>Same as <code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code>.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>logical denoting whether or not to return the fixed covariates model frame object in the fitted object</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>In <code>stap_glm</code>, logical scalar indicating whether to return the response vector. In <code>stan_glm.fit</code>, a response vector.</p></td>
    </tr>
    <tr>
      <th>contrasts</th>
      <td><p>Same as <code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code>, but
rarely specified.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to the function in the <span class="pkg">rstap</span> 
to specify <code>iter</code>, <code>chains</code>, <code>cores</code>, <code>refresh</code>, etc.</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>The prior distribution for the regression coefficients. 
<code>prior</code> should be a call to one of the various functions provided by 
<span class="pkg">rstap</span> for specifying priors. The subset of these functions that 
can be used for the prior on the coefficients can be grouped into several 
"families":</p>
<table class='table'>
<tr><td><strong>Family</strong></td><td><strong>Functions</strong></td></tr>
<tr><td><em>Student t family</em></td><td><code>normal</code>, <code>student_t</code>, <code>cauchy</code></td></tr>
<tr><td><em>Hierarchical shrinkage family</em></td><td><code>hs</code>, <code>hs_plus</code></td></tr>
<tr><td><em>Laplace family</em></td><td><code>laplace</code>, <code>lasso</code></td></tr>
<tr><td><em>Product normal family</em></td><td><code>product_normal</code></td></tr>
<tr><td></td><td><strong>Family</strong></td></tr>
</table>


<p>See the <a href='priors.html'>priors help page</a> for details on the families and 
how to specify the arguments for all of the functions in the table above.
To omit a prior ---i.e., to use a flat (improper) uniform prior---
<code>prior</code> can be set to <code>NULL</code>, although this is rarely a good
idea.</p>
<p><strong>Note:</strong> If <code>prior</code> is from the Student t
family or Laplace family, and if the <code>autoscale</code> argument to the 
function used to specify the prior (e.g. <code><a href='priors.html'>normal</a></code>) is left at 
its default and recommended value of <code>TRUE</code>, then the default or 
user-specified prior scale(s) may be adjusted internally based on the
scales of the predictors. See the <a href='priors.html'>priors help page</a> and the
<em>Prior Distributions</em> vignette for details on the rescaling and the
<code><a href='prior_summary.stapreg.html'>prior_summary</a></code> function for a summary of the priors used for a
particular model.</p></td>
    </tr>
    <tr>
      <th>prior_intercept</th>
      <td><p>The prior distribution for the intercept. 
<code>prior_intercept</code> can be a call to <code>normal</code>, <code>student_t</code> or 
<code>cauchy</code>. See the <a href='priors.html'>priors help page</a> for details on 
these functions. To omit a prior on the intercept ---i.e., to use a flat
(improper) uniform prior--- <code>prior_intercept</code> can be set to
<code>NULL</code>.</p>
<p><strong>Note:</strong> The prior distribution for the intercept is set so it
applies to the value <em>when all predictors are centered</em>. If you prefer
to specify a prior on the intercept without the predictors being
auto-centered, then you have to omit the intercept from the
<code><a href='http://www.rdocumentation.org/packages/stats/topics/formula'>formula</a></code> and include a column of ones as a predictor,
in which case some element of <code>prior</code> specifies the prior on it,
rather than <code>prior_intercept</code>. Regardless of how
<code>prior_intercept</code> is specified, the reported <em>estimates</em> of the
intercept always correspond to a parameterization without centered
predictors (i.e., same as in <code>glm</code>).</p></td>
    </tr>
    <tr>
      <th>prior_stap</th>
      <td><p>prior for spatial-temporal aggregated predictors. Note that prior is set on the standardized latent covariates.</p></td>
    </tr>
    <tr>
      <th>prior_theta</th>
      <td><p>prior for the spatial-temporal aggregated predictors' scale. Can either be a single prior or a prior nested within a list of lists.</p></td>
    </tr>
    <tr>
      <th>prior_aux</th>
      <td><p>The prior distribution for the "auxiliary" parameter (if
applicable). The "auxiliary" parameter refers to a different parameter 
depending on the <code>family</code>. For Gaussian models <code>prior_aux</code> 
controls <code>"sigma"</code>, the error 
standard deviation. For negative binomial models <code>prior_aux</code> controls 
<code>"reciprocal_dispersion"</code>, which is similar to the 
<code>"size"</code> parameter of <code><a href='http://www.rdocumentation.org/packages/stats/topics/NegBinomial'>rnbinom</a></code>:
smaller values of <code>"reciprocal_dispersion"</code> correspond to 
greater dispersion. For gamma models <code>prior_aux</code> sets the prior on 
to the <code>"shape"</code> parameter (see e.g., 
<code><a href='http://www.rdocumentation.org/packages/stats/topics/GammaDist'>rgamma</a></code>), and for inverse-Gaussian models it is the 
so-called <code>"lambda"</code> parameter (which is essentially the reciprocal of
a scale parameter). Binomial and Poisson models do not have auxiliary 
parameters.</p>
<p><code>prior_aux</code> can be a call to <code>exponential</code> to 
use an exponential distribution, or <code>normal</code>, <code>student_t</code> or 
<code>cauchy</code>, which results in a half-normal, half-t, or half-Cauchy 
prior. See <code><a href='priors.html'>priors</a></code> for details on these functions. To omit a 
prior ---i.e., to use a flat (improper) uniform prior--- set 
<code>prior_aux</code> to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>adapt_delta</th>
      <td><p>See the <a href='adapt_delta.html'>adapt_delta</a> help page for details.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <a href='stapreg-objects.html'>stapreg</a> object is returned 
for <code>stap_glm</code>.</p>
<p>A stapfit object (or a slightly modified 
  stapfit object) is returned if <code>stan_glm.fit</code> is called directly.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>stap_glm</code> function is similar in syntax to
<code><a href='http://www.rdocumentation.org/packages/rstanarm/topics/stan_glm'>stan_glm</a></code> except instead of performing full bayesian
inference for a generalized linear model stap_glm incorporates spatial-temporal covariates</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gelman, A. and Hill, J. (2007). <em>Data Analysis Using
  Regression and Multilevel/Hierarchical Models.</em> Cambridge University Press,
  Cambridge, UK.</p>
<p>Muth, C., Oravecz, Z., and Gabry, J. (2018)
User-friendly Bayesian regression modeling: A tutorial with rstanarm and shinystan.
<em>The Quantitative Methods for Psychology</em>. 14(2), 99--119.
<a href='https://www.tqmp.org/RegularArticles/vol14-2/p099/p099.pdf'>https://www.tqmp.org/RegularArticles/vol14-2/p099/p099.pdf</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='stapreg-methods.html'>stapreg-methods</a></code> and 
<code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code>.</p>
<p>The various vignettes for <code>stap_glm</code> at
  <a href='https://biostatistics4socialimpact.github.io/rstap/articles'>https://biostatistics4socialimpact.github.io/rstap/articles</a> and the <a href='http://arxiv.org/abs/1812.10208'>preprint</a> article.</p></div>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Adam Peterson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

